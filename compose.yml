services:
    green_click_app:
        build: ./src
        ports:
            - "8080:8080"
        volumes:
            - ./src/modules/User:/var/www/modules/User:ro
        environment:
            - APP_KEY=base64:lc+OjpBujxDeIC/eORynvRGr3i6pBuobE2gzuDI+wRs=
            - DB_CONNECTION=mysql
            - DB_HOST=green_click_mysql
            - DB_PORT=3306
            - DB_DATABASE=laravel
            - DB_USERNAME=root
            - DB_PASSWORD=root
        depends_on:
            - green_click_mysql

    green_click_mysql:
        image: mysql:8.0
        ports:
            - "3306:3306"
        environment:
            MYSQL_DATABASE: laravel
            MYSQL_ROOT_PASSWORD: root
        volumes:
            - green_click_mysql_data:/var/lib/mysql
        healthcheck:
            test: ["CMD", "mysqladmin", "ping", "-h", "localhost", "-u", "root", "-p$$MYSQL_ROOT_PASSWORD"]
            interval: 5s
            timeout: 5s
            retries: 10
        restart: unless-stopped

volumes:
    green_click_mysql_data: {}
